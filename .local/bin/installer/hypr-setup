#!/bin/sh

# chrome://flags - ozone > auto
# about:config - media.peerconnection.enabled > true

for dir in hypr waybar swaylock xsettingsd nwg-look; do
	cp -r "$HOME/dotfiles/.config/$dir" "$HOME/.config"
done

# AUR
paru -S hyprland-git xdg-desktop-portal-hyprland \
	wlr-randr hyprpicker swaylock-effects \
	grim slurp swappy swww sddm-git libsixel \
	hyprprop wlsunset waypipe nwg-look \
	hyprland-nvidia-git \
	libva libva-nvidia-driver-git
# rofi-lbonn-wayland-git
# kooha - Minimalistic screen recorder, using the xdg-desktop-portal ScreenCast protocol
# ydotool - A generic Linux command-line automation tool for Wayland
# waydroid - Container-based approach to boot a full Android system

## https://wiki.hyprland.org/Nvidia/

# Nvidia driver and mkinitcpio
# modules_to_add="nvidia nvidia_modeset nvidia_uvm nvidia_drm"
# sed -i "s/^MODULES=.*/MODULES=($modules_to_add)/" /etc/mkinitcpio.conf
# sudo mkinitcpio --config /etc/mkinitcpio.conf --generate /boot/initramfs-custom.img

# Setting for the NVIDIA kernel module
printf "Setup kernel module for NVIDIA? (y/N): "
read -r choice
if [ "$choice" = "y" ]; then
	sudo cat <<EOF | sudo tee /etc/modprobe.d/nvidia.conf
options nvidia-drm modeset=1
EOF
else
	:
fi

sudo pacman -S --noconfirm waybar file-roller tumbler wlroots polkit-gnome \
	qt5-wayland qt6-wayland viewnior sddm-runit \
	wl-clipboard wf-recorder ffmpegthumbs

sudo cat <<EOF | sudo tee /usr/share/wayland-sessions/hyprland.desktop
[Desktop Entry]
Name=Hyprland
Comment=An intelligent dynamic tiling Wayland compositor
Exec=dbus-launch Hyprland
Type=Application
EOF

# Sddm theme
printf "Do you want to change sddm theme? (y/N): "
read -r choice
if [ "$choice" = "y" ]; then
	sudo cat <<EOF | sudo tee /etc/sddm.conf.d/sddm.conf
[Theme]
Current=elarun
Font=MapleMono NF
EOF
	sudo cp -r ~/.local/share/walls/astro.jpg /usr/share/sddm/themes/elarun/images/background.png
else
	:
fi
