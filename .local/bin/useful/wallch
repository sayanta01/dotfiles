#!/bin/sh

current_session=$XDG_CURRENT_DESKTOP

set_wall_hyprland() {
	dir="${HOME}/.local/share/walls"
	BG="$(find "$dir" -name '*.jpg' -o -name '*.png' | shuf -n1)"
	PROGRAM="swww-daemon"
	trans_type="simple"

	if pgrep "$PROGRAM" >/dev/null; then
		swww img "$BG" --transition-fps 144 --transition-type $trans_type --transition-duration 1
	else
		swww-daemon && swww img "$BG" --transition-fps 144 --transition-type $trans_type --transition-duration 1
	fi
}

set_wall_other() {
	dir="${HOME}/.local/share/walls"
	BG="$(find "$dir" -name '*.jpg' -o -name '*.png' | shuf -n1)"
	cat "$BG" > ~/.local/share/walls/wallpaper.jpg
	xwallpaper --zoom "$BG"
}

case "$current_session" in
"Hyprland")
	set_wall_hyprland
	;;
*)
	set_wall_other
	;;
esac
